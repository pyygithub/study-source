<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hadoop 笔记 | PYY在线笔记文档</title>
    <meta name="description" content="PYY在线笔记文档">
    <meta name="generator" content="VuePress 1.3.1">
    <link rel="icon" href="/study/img/logo.png">
    
    <link rel="preload" href="/study/assets/css/0.styles.adf990bf.css" as="style"><link rel="preload" href="/study/assets/js/app.1bb3ed88.js" as="script"><link rel="preload" href="/study/assets/js/2.ee6e2511.js" as="script"><link rel="preload" href="/study/assets/js/4.e425903e.js" as="script"><link rel="prefetch" href="/study/assets/js/3.0a7cdb18.js"><link rel="prefetch" href="/study/assets/js/5.e593674e.js"><link rel="prefetch" href="/study/assets/js/6.59ee0dd8.js"><link rel="prefetch" href="/study/assets/js/7.84599eee.js"><link rel="prefetch" href="/study/assets/js/8.0152cbfd.js">
    <link rel="stylesheet" href="/study/assets/css/0.styles.adf990bf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/study/" class="home-link router-link-active"><img src="/study/img/logo.png" alt="PYY在线笔记文档" class="logo"> <span class="site-name can-hide">PYY在线笔记文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/study/大数据/" class="nav-link">
  大数据
</a></div><div class="nav-item"><a href="https://www.jianshu.com/u/af08f637aff8" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/pyy-admin-x" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/study/大数据/" class="nav-link">
  大数据
</a></div><div class="nav-item"><a href="https://www.jianshu.com/u/af08f637aff8" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/pyy-admin-x" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>大数据</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/study/%E5%A4%A7%E6%95%B0%E6%8D%AE/" class="sidebar-link">介绍</a></li><li><a href="/study/大数据/Hadoop 笔记.html" class="active sidebar-link">Hadoop 笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#大数据概念" class="sidebar-link">大数据概念</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#什么是大数据？" class="sidebar-link">什么是大数据？</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#大数据特点？" class="sidebar-link">大数据特点？</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#面临了哪些问题-如何解决？" class="sidebar-link">面临了哪些问题,如何解决？</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#大数据应用场景" class="sidebar-link">大数据应用场景</a></li></ul></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#hadoop-的诞生" class="sidebar-link">Hadoop 的诞生</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#hadoop-的起源" class="sidebar-link">Hadoop 的起源</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#hadoop-的历史版本" class="sidebar-link">Hadoop 的历史版本</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#hadoop-生态圈" class="sidebar-link">Hadoop 生态圈</a></li></ul></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#大数据解决方案" class="sidebar-link">大数据解决方案</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#hdfs-分布式系统配置" class="sidebar-link">HDFS 分布式系统配置</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#hdfs-体系架构" class="sidebar-link">HDFS 体系架构</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#hdfs-命令行客户端基本操作" class="sidebar-link">HDFS 命令行客户端基本操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#客户端理解" class="sidebar-link">客户端理解</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#hdfs-命令行客户端的常用操作命令" class="sidebar-link">HDFS 命令行客户端的常用操作命令</a></li></ul></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#hdfs-的-javaapi" class="sidebar-link">HDFS 的 JavaAPI</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#开发环境准备" class="sidebar-link">开发环境准备</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#文件上传" class="sidebar-link">文件上传</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#下载文件" class="sidebar-link">下载文件</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#创建文件夹" class="sidebar-link">创建文件夹</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#删除文件" class="sidebar-link">删除文件</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#递归查询目录下所有文件列表" class="sidebar-link">递归查询目录下所有文件列表</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#判断文件是否存在" class="sidebar-link">判断文件是否存在</a></li><li class="sidebar-sub-header"><a href="/study/大数据/Hadoop 笔记.html#回收站" class="sidebar-link">回收站</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="hadoop-笔记"><a href="#hadoop-笔记" class="header-anchor">#</a> Hadoop 笔记</h1> <h2 id="大数据概念"><a href="#大数据概念" class="header-anchor">#</a> 大数据概念</h2> <h3 id="什么是大数据？"><a href="#什么是大数据？" class="header-anchor">#</a> 什么是大数据？</h3> <blockquote><p><strong>(KB - MB - GB - TB - PB - EB - ZB - YB - DB - NB)：</strong></p> <p>(bit).Byte (B).KiloByte (KB).MegaByte (MB).GigaByte (GB).TeraByte (TB).PetaByte (PB).ExaByte (EB).ZetaByte (ZB).YottaByte (YB).NonaByte (NB).DoggaByte (DB)1 Byte = 8 Bit</p> <p>1 KB = 1,024 Bytes
1 MB = 1,024 KB = 1,048,576 Bytes
1 GB = 1,024 MB = 1,048,576 KB = 1,073,741,824 Bytes
1 TB = 1,024 GB = 1,048,576 MB = 1,073,741,824 KB = 1,099,511,627,776 Bytes
1 PB = 1,024 TB = 1,048,576 GB =1,125,899,906,842,624 Bytes （13107.2个80G的
1 EB = 1,024 PB = 1,048,576 TB = 1,152,921,504,606,846,976 Bytes
1 ZB = 1,024 EB = 1,180,591,620,717,411,303,424 Bytes
1 YB = 1,024 ZB = 1,208,925,819,614,629,174,706,176 Bytes
1 DB = 1,024 YB＝ 1,237,940,039,285,380,274,899,124,224 Bytes
1 NB = 1,024 DB＝ 1,267,650,600,228,229,401,496,703,205,376 Bytes</p></blockquote> <p>一般来说达到 TB ，或日增达到 GB 就属于大数据了
MySQL 单表超过 500万 条数据</p> <h3 id="大数据特点？"><a href="#大数据特点？" class="header-anchor">#</a> 大数据特点？</h3> <p><strong>大数据的 5V 特性：</strong></p> <ul><li><p><strong>Volume：巨大的数据量</strong>
集中储存/集中计算已经无法处理巨大的数据量。
数据量呈指数增长：地震、录井 、石油钻塔的传感器一个月产生的数据量比全球所有的电影加在一起还要多。
新浪微博用户数2.5亿+，高峰每天几亿条。</p></li> <li><p><strong>Variety：非结构化数据多样性</strong>
文本/图片/视频/文档等，如诸如微地震，电磁以及光纤分布式温度监测（DTS） 。</p></li> <li><p><strong>Velocity：数据增长速度快</strong>
用户基数庞大/设备数量众多/实时海量/数据指数级别增长。</p></li> <li><p><strong>Valueless：数据价值密度低</strong>
每个钻井平台有 40,000 传感器,但是通常只有 10% 的数据使用到。
每个深水钻井平台的投资可达到$150M,能有效利用所有的数据非常关键,关系到安全与优化运营 。</p></li> <li><p><strong>Veracity：数据质量</strong>
数据的准确性和可信赖度，即数据的质量。</p></li></ul> <h3 id="面临了哪些问题-如何解决？"><a href="#面临了哪些问题-如何解决？" class="header-anchor">#</a> 面临了哪些问题,如何解决？</h3> <ul><li>数据如何存储 - HDFS</li> <li>数据如何计算 - MapReduce</li> <li>资源如何管理（CPU 内存 网络资源）- YARN</li></ul> <h3 id="大数据应用场景"><a href="#大数据应用场景" class="header-anchor">#</a> 大数据应用场景</h3> <ul><li><p><strong>个人推荐</strong>
根据用户喜好，推荐相关兴趣内容
千人一面：范围广、精度粗
一人一面：范围小、精度高
一人千面：兴趣内容范围大、精度高</p></li> <li><p><strong>风控</strong>
金融系统、银行、互联网金融 - 实时流处理</p></li> <li><p><strong>成本预测</strong>
根据近期销售和市场数据，预测成本，做出规划</p></li> <li><p><strong>气候预测</strong>
根据以往气象信息，预测近期气象变化，和推测之后气候异常</p></li> <li><p><strong>人工智能</strong>
无人汽车：百度、特斯拉、Google
智能助手：小爱、小度
物流机器人</p></li></ul> <h2 id="hadoop-的诞生"><a href="#hadoop-的诞生" class="header-anchor">#</a> Hadoop 的诞生</h2> <p>由 Apache 组织提供的一个开源的大数据解决方案。</p> <h3 id="hadoop-的起源"><a href="#hadoop-的起源" class="header-anchor">#</a> Hadoop 的起源</h3> <ul><li><p>2003-2004年，Google公布了部分GFS和MapReduce思想的细节，受此启发的Doug Cutting等人用2年的业余时间实现了DFS和MapReduce机制，使Nutch性能飙升。然后Yahoo招安Doug Gutting及其项目。</p></li> <li><p>2005年，Hadoop作为Lucene的子项目Nutch的一部分正式引入Apache基金会。</p></li> <li><p>2006年2月被分离出来，成为一套完整独立的软件，起名为Hadoop。Hadoop名字不是一个缩写，而是一个生造出来的词。是Hadoop之父Doug Cutting儿子毛绒玩具象命名的。</p></li> <li><p>Hadoop的成长过程
Lucene–&gt;Nutch—&gt;Hadoop</p></li> <li><p>总结起来，Hadoop起源于Google的三大论文</p> <ul><li>GFS：Google的分布式文件系统Google File System</li> <li>MapReduce：Google的MapReduce开源分布式并行计算框架</li> <li>BigTable：一个大型的分布式数据库</li></ul></li> <li><p>演变关系
GFS—-&gt;HDFS
Google MapReduce—-&gt;Hadoop MapReduce
BigTable—-&gt;HBase</p></li></ul> <p>狭义上来说，hadoop就是单独指代hadoop这个软件，
广义上来说，hadoop指代大数据的一个生态圈，包括很多其他的软件</p> <h3 id="hadoop-的历史版本"><a href="#hadoop-的历史版本" class="header-anchor">#</a> Hadoop 的历史版本</h3> <ul><li><strong>0.x系列版本</strong>：hadoop当中最早的一个开源版本，在此基础上演变而来的1.x以及2.x的版本</li> <li><strong>1.x版本系列</strong>：hadoop版本当中的第二代开源版本，主要修复0.x版本的一些bug等</li> <li><strong>2.x版本系列</strong>：架构产生重大变化，引入了yarn平台等许多新特性</li></ul> <h3 id="hadoop-生态圈"><a href="#hadoop-生态圈" class="header-anchor">#</a> Hadoop 生态圈</h3> <ul><li><strong>HDFS</strong>：Hadoop Distribute FileSystem</li> <li><strong>MapReduce</strong>：Hadoop中的分布式计算框架，实现对海量数据的并行分析和计算。</li> <li><strong>Hbase</strong>：基于HDFS的列式存储的 NoSQL 数据库。</li> <li><strong>Hive</strong>：简化大数据开发，可以将 SQL 语法翻译成 MR 任务。</li> <li><strong>Flume</strong>：分布式的日志收集系统，用于收集海量数据，将其存储到 FS 中。</li> <li><strong>Kafka</strong>：分布式的消息系统，实现分布式解耦和海量数据缓冲。</li> <li><strong>Zookeeper</strong>：分布式协调服务，用于服务注册中心、配置中心、集群选举、状态监测、分布式锁等。</li></ul> <h2 id="大数据解决方案"><a href="#大数据解决方案" class="header-anchor">#</a> 大数据解决方案</h2> <ul><li><strong>MR</strong>：代表基于<strong>磁盘</strong>的大数据离线批处理的解决方案 - 延迟较高</li> <li><strong>Spark</strong>：代表基于<strong>内存</strong>的大数据静态批处理的解决方案 - 几乎是MR的10倍以上</li> <li><strong>Storm/Spark Streaming/Flink/Kafka Streaming</strong>：实时流处理框架，达到对记录级别的数据显示和毫秒级处理</li></ul> <h2 id="hdfs-分布式系统配置"><a href="#hdfs-分布式系统配置" class="header-anchor">#</a> HDFS 分布式系统配置</h2> <p><strong>核心配置参数：</strong></p> <ul><li>指定 hadoop 的默认文件系统为：hdfs</li> <li>指定 hdfs 的 namenode 节点是哪台机器</li> <li>指定 namenode 软件存储元数据的本地目录</li> <li>指定 datanode 软件存储文件块的本地目录</li></ul> <ol><li><p>环境配置文件hadoop-env.sh</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># The java implementation to use.</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/opt/soft/jdk1.8.0_211
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_CONF_DIR</span><span class="token operator">=</span><span class="token variable">${HADOOP_CONF_DIR<span class="token operator">:-</span>$PWD}</span> <span class="token comment">#Hadoop配置文件的存放目录</span>
</code></pre></div></li> <li><p>核心配置文件 core-site.xml</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- fs.defaultFS: 默认文件系统 hdfs  --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>fs.defaultFS<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hdfs://hdp-01:9000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>HDFS配置文件hdfs-site.xml</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- namenode 地址 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.http-address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hdp-01:50070<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- secondary namenode 地址 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.http-address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hdp-01:50090<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!-- 指定 namenode 软件存储元数据的本地目录 格式化节点时会自动生成--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.name.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/root/hdpdata/name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 指定 datanode 软件存储文件块的本地目录 格式化节点时会自动生成   --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.datanode.data.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/root/hdpdata/data<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span> 

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>配置datanode集群节点文件 slaves</p> <div class="language-shell extra-class"><pre class="language-shell"><code>hdp-01
hdp-02
hdp-03
</code></pre></div></li> <li><p>配置好以上信息后，我们就可以将hadoop的包分发给其他的节点了</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">scp</span> -r hadoop-2.x.x root@hdp02:<span class="token punctuation">(</span>目标路径<span class="token punctuation">)</span>
</code></pre></div></li> <li><p>启动集群</p> <p>在主节点上运行</p> <div class="language- extra-class"><pre class="language-text"><code>hadoop namenode -format
</code></pre></div><p>运行完成后，节点会自动生成刚刚配置的工作目录</p> <div class="language- extra-class"><pre class="language-text"><code>start-dfs.sh
</code></pre></div></li> <li><p>浏览器输入http://x.x.x.x:50070查看集群运行情况</p> <p><img src="/study/assets/img/namenode.f626aa82.png" alt="namenode"></p></li> <li><p>最终服务器分布：</p> <table><thead><tr><th>服务器地址</th> <th>端口</th> <th>服务</th></tr></thead> <tbody><tr><td>hdp-01</td> <td>50070<br>50090</td> <td>namenode<br>secondaryNamenode<br>datanode</td></tr> <tr><td>hdp-02</td> <td>50010/50075</td> <td>datanode</td></tr> <tr><td>hdp-03</td> <td>50010/50075</td> <td>datanode</td></tr></tbody></table></li> <li><p><strong>问题总结</strong></p> <ul><li>防火墙设置
为了防止发生一些奇怪的错误，请务必关闭所有节点的防火墙，他可能会导致浏览器无法获取集群信息和文件上传集群失败</li> <li>hosts文件配置和主机名
因为这是完全分布式的集群，所以配置hosts文件至关重要，不然你的私钥配置和以后节点的格式化都会出错，他将会提示你无法解析主机名</li> <li>请在关闭所有HDFS服务后在执行<code>-format</code>格式化命令
如果存在节点未关闭，而你运行了格式化命令，这可能导致该节点与其他节点的目录ID不一致，从而导致“网络分区”问题</li></ul></li></ol> <h2 id="hdfs-体系架构"><a href="#hdfs-体系架构" class="header-anchor">#</a> HDFS 体系架构</h2> <ol><li><p><strong>NameNode</strong></p> <p>是主节点，<strong>存储文件的元数据</strong>如<code>文件名、文件目录结构、文件属性(生成时间、福本数、文件权限)</code> ，以及每个文件的块列表和块所在的 <strong>DateNode</strong> 等。</p></li> <li><p>**DataNode **</p> <p>在本地文件系统<strong>存储文件块数据，以及块数据的校验和</strong></p></li> <li><p><strong>Block（128M）</strong></p> <p><img src="/study/assets/img/HDFS.fa7eae62.png" alt="img"></p></li></ol> <h2 id="hdfs-命令行客户端基本操作"><a href="#hdfs-命令行客户端基本操作" class="header-anchor">#</a> HDFS 命令行客户端基本操作</h2> <h3 id="客户端理解"><a href="#客户端理解" class="header-anchor">#</a> 客户端理解</h3> <p>HDFS 的客户端有多种形式：</p> <ul><li>网页形式</li> <li>命令行形式</li></ul> <p>客户端在哪里运行，没有约束，只要运行客户端的机器能够跟 HDFS 集群联网。</p> <blockquote><p>注意：文件的切块大小和存储的福本数量，都是由客户端决定的！</p></blockquote> <p>所谓客户端决定，是通过配置参数类定的。HDFS 的客户端会读取以下两个参数，来决定切块大小和副本数量：</p> <ul><li>切块大小参数：dfs.blocksize</li> <li>副本数量的参数：dfs.replication</li></ul> <p>上面两个参数在 hdfs-site.xml 中配置：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.blocksize<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>128m<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.replication<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="hdfs-命令行客户端的常用操作命令"><a href="#hdfs-命令行客户端的常用操作命令" class="header-anchor">#</a> HDFS 命令行客户端的常用操作命令</h3> <ol><li><p>查看 HDFS 目录信息</p> <div class="language-shell extra-class"><pre class="language-shell"><code>hadoop fs -ls /hdfs目录
</code></pre></div></li> <li><p>在 HDFS 中创建文件夹</p> <div class="language-sh extra-class"><pre class="language-sh"><code>hadoop fs -mkdir -p /aa/bb/cc
</code></pre></div></li> <li><p>移动 HDFS 中的文件（改名）</p> <div class="language-sh extra-class"><pre class="language-sh"><code>hadoop fs -mv /hdfs路径	/hdfs另一个路径
</code></pre></div></li> <li><p>上传文件到 HDFS 中</p> <div class="language-sh extra-class"><pre class="language-sh"><code>hadoop fs -put /本地文件 /hdfs目录
hadoop fs -copyFromLocal/本地文件	/hdfs目录   <span class="token comment">## copyFromLocak == put</span>
hadoop fs -moveFromLocal/本地文件	/hdfs目录		<span class="token comment">## 从本地移动到hdfs</span>
</code></pre></div></li> <li><p>下载文件到客户端本地</p> <div class="language-sh extra-class"><pre class="language-sh"><code>hadoop fs -get /hdfs中的文件	/本地目录
hadoop fs -copyToLocal/hdfs中的文件	/本地目录	<span class="token comment">## copyToLocal == get</span>
hadoop fs -moveToLocal/hdfs中的文件 /本地目录	<span class="token comment">## 从 hdfs 中移动到本地</span>
</code></pre></div></li> <li><p>删除 HDFS 中的文件或文件夹</p> <div class="language-sh extra-class"><pre class="language-sh"><code>hadoop fs <span class="token function">rm</span> -r /hdfs目录或文件
</code></pre></div></li> <li><p>修改文件的权限</p> <div class="language-sh extra-class"><pre class="language-sh"><code>hadoop fs -chown user:group /hdfs文件
hadoop fs -chmod <span class="token number">777</span> /hdfs文件
</code></pre></div></li> <li><p>追加内容到已有文件</p> <div class="language-sh extra-class"><pre class="language-sh"><code>hadoop fs -appendToFile /本地文件	/hdfs文件
</code></pre></div></li> <li><p>显示文本文件内容</p> <div class="language-sh extra-class"><pre class="language-sh"><code>hadoop fs -cat /hdfs文件
hadoop fs -tail /hdfs文件 
</code></pre></div></li></ol> <h2 id="hdfs-的-javaapi"><a href="#hdfs-的-javaapi" class="header-anchor">#</a> HDFS 的 JavaAPI</h2> <h3 id="开发环境准备"><a href="#开发环境准备" class="header-anchor">#</a> 开发环境准备</h3> <ol><li>在本地解决Hadoop安装包</li> <li>在环境变量中配置：HADOOP_HOME</li> <li>创建 SpringBoot 工程,引入 Hadoop 依赖包</li></ol> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- hadoop-hdfs --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.hadoop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hadoop-hdfs<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.10.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- hadoop-common --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.hadoop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hadoop-common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.10.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="文件上传"><a href="#文件上传" class="header-anchor">#</a> 文件上传</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>conf</span><span class="token punctuation">.</span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs</span><span class="token punctuation">.</span><span class="token class-name">FSDataOutputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs</span><span class="token punctuation">.</span><span class="token class-name">FileSystem</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs</span><span class="token punctuation">.</span><span class="token class-name">Path</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">IOUtils</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit</span><span class="token punctuation">.</span><span class="token class-name">After</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit</span><span class="token punctuation">.</span><span class="token class-name">Before</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit</span><span class="token punctuation">.</span><span class="token class-name">Test</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">File</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">FileInputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">FileNotFoundException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">IOException</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token punctuation">{</span>
    <span class="token class-name">Configuration</span> configuration<span class="token punctuation">;</span>
    <span class="token class-name">FileSystem</span> fs<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Before</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">&quot;HADOOP_USER_NAME&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        configuration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 手动设置连接信息</span>
        <span class="token comment">//configuration.set(&quot;fs.defaultFS&quot;, &quot;&quot;)</span>
        configuration<span class="token punctuation">.</span><span class="token function">addResource</span><span class="token punctuation">(</span><span class="token string">&quot;core-site.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        configuration<span class="token punctuation">.</span><span class="token function">addResource</span><span class="token punctuation">(</span><span class="token string">&quot;hdfs-site.xml &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        fs <span class="token operator">=</span> <span class="token class-name">FileSystem</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span>configuration<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@After</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        fs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">upload1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        fs<span class="token punctuation">.</span><span class="token function">copyFromLocalFile</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">&quot;/本地文件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">upload2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">FileInputStream</span> inputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;/本地文件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FSDataOutputStream</span> outputStream <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">&quot;/a.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IOUtils</span><span class="token punctuation">.</span><span class="token function">copyBytes</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">,</span> outputStream<span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>权限不足解决方案</strong></p> <div class="language-java extra-class"><pre class="language-java"><code>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>security<span class="token punctuation">.</span><span class="token class-name">AccessControlException</span><span class="token operator">:</span> <span class="token class-name">Permission</span> denied<span class="token operator">:</span> user<span class="token operator">=</span>wolf<span class="token punctuation">,</span> access<span class="token operator">=</span>WRITE<span class="token punctuation">,</span> inode<span class="token operator">=</span><span class="token string">&quot;/&quot;</span><span class="token operator">:</span>root<span class="token operator">:</span>supergroup<span class="token operator">:</span>drwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><ul><li><p>方案一：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">&quot;HADOOP_USER_NAME&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>方案二：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>java -jar xxxx -DHADOOP_USER_NAME<span class="token operator">=</span>root
</code></pre></div></li> <li><p>方案三：</p> <blockquote><p>将权限检查机制关闭：ect/hadoop/hdfs-site.xml:</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.permissions.enabled<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span>
	<span class="token attr-name">&lt;value</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li></ul> <h3 id="下载文件"><a href="#下载文件" class="header-anchor">#</a> 下载文件</h3> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">download1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        fs<span class="token punctuation">.</span><span class="token function">copyToLocalFile</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">&quot;/hdfs文件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">&quot;/本地目录&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">download2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">FileInputStream</span> inputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;hdfs文件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FSDataOutputStream</span> outputStream <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">&quot;/本地目录&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IOUtils</span><span class="token punctuation">.</span><span class="token function">copyBytes</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">,</span> outputStream<span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="创建文件夹"><a href="#创建文件夹" class="header-anchor">#</a> 创建文件夹</h3> <div class="language-java extra-class"><pre class="language-java"><code>		<span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        fs<span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">&quot;/a/b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="删除文件"><a href="#删除文件" class="header-anchor">#</a> 删除文件</h3> <div class="language-java extra-class"><pre class="language-java"><code>		<span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 递归删除</span>
        <span class="token keyword">boolean</span> delete <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">&quot;/a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="递归查询目录下所有文件列表"><a href="#递归查询目录下所有文件列表" class="header-anchor">#</a> 递归查询目录下所有文件列表</h3> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">listFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">RemoteIterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">LocatedFileStatus</span><span class="token punctuation">&gt;</span></span> remoteIterator <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">listFiles</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>remoteIterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">LocatedFileStatus</span> fileStatus <span class="token operator">=</span> remoteIterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> name <span class="token operator">=</span> fileStatus<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="判断文件是否存在"><a href="#判断文件是否存在" class="header-anchor">#</a> 判断文件是否存在</h3> <div class="language-java extra-class"><pre class="language-java"><code>		<span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">exist</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">boolean</span> exists <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">&quot;/a.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>exists<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="回收站"><a href="#回收站" class="header-anchor">#</a> 回收站</h3> <div class="language-java extra-class"><pre class="language-java"><code>		<span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">trash</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Trash</span> trash <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Trash</span><span class="token punctuation">(</span>fs<span class="token punctuation">,</span> configuration<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> b <span class="token operator">=</span> trash<span class="token punctuation">.</span><span class="token function">moveToTrash</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">&quot;/a.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>·</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/study/%E5%A4%A7%E6%95%B0%E6%8D%AE/" class="prev router-link-active">
        介绍
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/study/assets/js/app.1bb3ed88.js" defer></script><script src="/study/assets/js/2.ee6e2511.js" defer></script><script src="/study/assets/js/4.e425903e.js" defer></script>
  </body>
</html>
